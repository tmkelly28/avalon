<section id="room">
	<!-- <h1>{{ game.name.split('').join(' ') }}</h1> -->

	<div class="col-md-12" id="players">

		<div class="player-box" 
			href="#"
			ng-repeat="player in game.players">

			<h5>{{ player.displayName }}</h5>
			<img ng-src="{{ player.picture }}"
				 ng-class="{activePlayer: (game.currentPlayerTurn._id === player._id)}" 
				 id="playerPicture"/>

			<img class="character" 
				 ng-src="{{ player.imageUrl }}"
				 ng-if="me(player)"/>

			<img ng-src="/icons/approve.png"
				 ng-if="player.approvedQuest && (game.currentGamePhase === 'quest voting' || game.currentGamePhase === 'team building')"
				 class="voteToken"/>
			<img ng-src="/icons/reject.png"
				 ng-if="!player.approvedQuest && (game.currentGamePhase === 'quest voting' || game.currentGamePhase === 'team building')"
				 class="voteToken"/>
			<img ng-src="/icons/sigil.png"
				 ng-if="player.onQuest"
				 class="sigil"/>

			<div id="playerSelection">
				<a name="addToTeam"
					ng-if="myTurn && game.roomLeftOnTeam && (game.currentGamePhase === 'team building') && !player.onQuest"
					href="#"
					class="selectPlayer"
					ng-click="addToTeam(player)">
					<span class="glyphicon glyphicon-plus"></span>
					Add to team</a>
				<a name="guessMerlin"
					ng-if="user.character === 'Assassin' && (game.currentGamePhase === 'guess merlin') && (player.loyalty === 'good' || player.character === 'Oberon')"
					href="#"
					class="selectPlayer"
					ng-click="guessMerlin(player)">
					Guess Merlin</a>
			</div>
		</div>

	</div>

	<!-- test box -->
<!-- 	<div class="well" id="test">
		<span>Me: {{ user.displayName }}</span>
		<span>Turn: {{ game.currentPlayerTurn.displayName }}</span>
		<span>Team:</span>
			<ul>
				<li ng-repeat="p in game.currentQuestPlayersGoing">
					{{p.displayName}}
				</li>
			</ul>
		<span>Quest #: {{ game.currentQuestIdx + 1 }}</span>
		<span>Players Needed: {{ game.currentQuestPlayersNeeded }}</span>
		<span>To fail: {{ game.currentQuestToFail }}</span>
		<span>On quest?: {{ user.onQuest }}</span>
		<span>Approved?: {{ user.approvedQuest }}
		<span>Vote Track: {{ game.currentVoteTrack }}</span>
		<span>Phase: {{ game.currentGamePhase }}</span>
		<span>Loyal Score: {{ game.loyalScore }}</span>
		<span>Evil Score: {{ game.evilScore }}</span>
		<span>Team Approves: {{ game.currentQuestApproves }}</span>
		<span>Team Rejects: {{ game.currentQuestRejects }}</span>
	</div>
 -->
 	<div class="well" id="gamelog">
 		<p ng-repeat="player in game.players">
 			<span ng-if="(user.character==='Percival') && (player.character==='Morgana')">
 				<span class="glyphicon glyphicon-eye-open"></span>
 				{{ player.displayName }} is a wizard
 			</span>
 			<span ng-if="(user.character==='Percival') && (player.character==='Merlin')">
 				<span class="glyphicon glyphicon-eye-open"></span>
 				{{ player.displayName }} is a wizard
 			</span>
 			<span ng-if="(user.loyalty==='evil') && (player.loyalty==='evil') && (player.character !=='Oberon')">
 				<span class="glyphicon glyphicon-eye-open"></span>
 				{{ player.displayName }} is a fellow agent of evil
 			</span>
 			<span ng-if="(user.character==='Merlin') && (player.loyalty==='evil') && (player.character !=='Mordred')">
 				<span class="glyphicon glyphicon-eye-open"></span>
 				{{ player.displayName }} is an agent of evil
 			</span>
 		</p>
 	</div>
	<div class="well" id="chat">
		<p ng-repeat="chat in chats | orderBy:'-'">{{ chat.text }}</p>
	</div>
	<div id="buttonBar">
		<form>
			<a 
				class="btn btn-success" 
			    ng-disabled="!ableToBegin()" 
			    ng-if="isHost()"
			    ng-click="startGame()">
			    Begin Game
			</a>
			<a 
				class="btn btn-default"  
			    ng-click="voteApprove()"
			    ng-if="game.currentGamePhase === 'team voting'">
			    Approve
			</a>
			<a 
				class="btn btn-default"  
			    ng-click="voteReject()"
			    ng-if="game.currentGamePhase === 'team voting'">
			    Reject
			</a>
			<a 
				class="btn btn-default"  
			    ng-click="successQuest()"
			    ng-if="(game.currentGamePhase === 'quest voting') && user.onQuest">
			    Success
			</a>
			<a 
				class="btn btn-default"  
			    ng-click="failQuest()"
			    ng-if="(game.currentGamePhase === 'quest voting') && user.onQuest">
			    Fail
			</a>
			<a 
				class="btn btn-default"  
			    ng-click="proposeTeam()"
			    ng-if="myTurn && (game.currentGamePhase === 'team building')">
			    Propose Team
			</a>
			<a 
				class="btn btn-default"
				ng-if="myTurn && (game.currentGamePhase === 'team building')"  
			    ng-click="resetTeam()">
			    Reset Team
			</a>
		</form>
	</div>
	<div id="chatEntry">
		<form name="chat">
			<div class="form-group">
				<input 
					name="chatInput" 
				    type="text"
					ng-model="newMessage.text"
					placeholder="Enter your message"
					class="form-control" />
			</div>
			<input 
				type="submit" 
				class="btn btn-default" 
				ng-click="addMessage()">
			</input>
		</form>
	</div>
</section>